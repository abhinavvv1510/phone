<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Palak or Phone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background-color: #fff8f0;
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      overflow: hidden;
      touch-action: none;
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-top: 20px;
    }

    .emoji {
      position: absolute;
      font-size: 4rem;
      cursor: grab;
      user-select: none;
      transition: transform 0.3s ease;
    }

    #boy { top: 60%; left: 20%; }
    #girl { top: 60%; left: 60%; }
    #phone { top: 30%; left: 50%; }

    #heart {
      position: absolute;
      font-size: 2.5rem;
      display: none;
      z-index: 5;
    }

    .hugged {
      animation: hugBounce 0.4s ease-in-out infinite alternate;
    }

    @keyframes hugBounce {
      from { transform: scale(1); }
      to { transform: scale(1.2); }
    }
  </style>
</head>
<body>

  <h1>Palak or Phone</h1>

  <div id="boy" class="emoji">üë¶</div>
  <div id="girl" class="emoji">üëß</div>
  <div id="phone" class="emoji">üì±</div>
  <div id="heart">‚ù§Ô∏è</div>

  <script>
    const boy = document.getElementById('boy');
    const girl = document.getElementById('girl');
    const phone = document.getElementById('phone');
    const heart = document.getElementById('heart');

    let dragging = false;
    let currentTarget = null;
    let offsetX = 0;
    let offsetY = 0;

    // DRAG START
    function startDrag(e, target) {
      dragging = true;
      currentTarget = target;

      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      offsetX = clientX - target.offsetLeft;
      offsetY = clientY - target.offsetTop;
    }

    // DRAG MOVE
    function onMove(e) {
      if (!dragging || !currentTarget) return;

      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      const x = clientX - offsetX;
      const y = clientY - offsetY;

      currentTarget.style.left = `${x}px`;
      currentTarget.style.top = `${y}px`;

      const boyRect = boy.getBoundingClientRect();
      const girlRect = girl.getBoundingClientRect();
      const phoneRect = phone.getBoundingClientRect();

      // HUG detection
      const dxGirl = girlRect.left - boyRect.left;
      const dyGirl = girlRect.top - boyRect.top;
      const distToGirl = Math.sqrt(dxGirl * dxGirl + dyGirl * dyGirl);

      if (distToGirl < 100) {
        boy.style.left = `${girl.offsetLeft - 60}px`;
        boy.style.top = `${girl.offsetTop}px`;
        heart.style.display = 'block';
        heart.style.left = `${girl.offsetLeft - 20}px`;
        heart.style.top = `${girl.offsetTop - 40}px`;
        boy.classList.add('hugged');
        girl.classList.add('hugged');
      } else {
        heart.style.display = 'none';
        boy.classList.remove('hugged');
        girl.classList.remove('hugged');
      }

      // PHONE repel
      const dxPhone = phoneRect.left - boyRect.left;
      const dyPhone = phoneRect.top - boyRect.top;
      const distToPhone = Math.sqrt(dxPhone * dxPhone + dyPhone * dyPhone);

      if (distToPhone < 100) {
        const angle = Math.atan2(dyPhone, dxPhone);
        const repelDist = 100;
        const newX = phone.offsetLeft + Math.cos(angle) * repelDist;
        const newY = phone.offsetTop + Math.sin(angle) * repelDist;
        const boundedX = Math.max(0, Math.min(window.innerWidth - 50, newX));
        const boundedY = Math.max(0, Math.min(window.innerHeight - 50, newY));
        phone.style.left = `${boundedX}px`;
        phone.style.top = `${boundedY}px`;
      }
    }

    // DRAG END
    function endDrag() {
      dragging = false;
      currentTarget = null;
    }

    // MOUSE EVENTS
    boy.addEventListener('mousedown', (e) => startDrag(e, boy));
    document.addEventListener('mousemove', onMove);
    document.addEventListener('mouseup', endDrag);

    // TOUCH EVENTS
    boy.addEventListener('touchstart', (e) => startDrag(e, boy));
    document.addEventListener('touchmove', onMove, { passive: false });
    document.addEventListener('touchend', endDrag);
  </script>
</body>
</html>
